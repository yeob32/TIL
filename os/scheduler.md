# 운영체제 스케줄러

## 스케줄러
> 프로세스가 생성되어 실행 될 때 필요한 시스템 자원을 해당 프로세스에게 할당하는 작업

### 목적
- CPU 자원 활용의 극대화

### 스케줄링
> 프로세스는 자신의 임무를 수행하고 사라질 때까지 많은 큐를 돌아다닌다. 
> 스케줄러가 어떤 프로세스에게 CPU를 할당 해줄 것인지 정하는 것

### 스케줄링 큐
- Job Queue : 현재 시스템 내의 모든 프로세스 집합
- Ready Queue : 현재 메모리 내에 있으면서 CPU를 잡아서 실행되기를 기다리는 프로세스의 집합
- Device Queue : Device I/O 작업을 대기하고 있는 프로세스의 집합

### 장기 스케줄러 (Long Term Scheduler)
- 디스크에 저장되어 있는 프로세스들을 메인 메모리로 적재
- 어떤 프로세스에 메모리를 할당 하여 Ready Queue 로 보낼지 결정하는 작업
- 작업 스케줄링, 상위 스케줄링이라고도 하며, 작업 스케줄러에 의해 수행
- 프로세스 상태 전이
    - new -> ready
    
### 단기 스케줄러 (Short Term Scheduler)
- Ready Queue 에 존재하는 먼저 도착한 프로세스에게 CPU 할당 (Dispatch)
- CPU 와 메모리 사이의 스케줄링을 담당.
- 프로세스 상태 전이
    - ready -> running

### 중기 스케줄러 (Medium Term Scheduler)
- 프로세스들이 서로 CPU를 차지하려고 경쟁이 심해지면, swapping으로 메모리 관리
- 메모리에서 CPU를 쓰기 위한 경쟁 프로세스들을 어느 정도 제거, 나중에 다시 메모리로 불러와 중단된 지점을 다시 실행 (swapping)
- swapping 기법
    - swap out : 메모리에서 디스크로 잠시 나가는 상태 
    - swap in : 디스크에서 메모리로 다시 들여오는 상태 
    
### 선점형 스케줄러 (Preemptive Scheduling)
- 하나의 프로세스가 다른 프로세스 대신에 프로세서(CPU)를 차지 할 수 있음
- 프로세스 running 중에 스케줄러가 이를 중단시키고, 다른 프로세스로 교체 가능

### 비선점형 스케줄러 (Non-Preemptive Scheduling)
- 하나의 프로세스가 끝나지 않으면 다른 프로세스는 CPU를 사용할 수 없음
- 프로세스가 자발적으로 blocking 상태로 들어가거나, 실행이 끝났을 때만 다른 프로세스로 교체 가능

### 스케줄링 알고리즘
- 비선점
    - 선입 선처리 스케줄링(FCFS, First Come First Served or FIFO)
        - 구현이 간단하다.
        - Ready queue 에 도착한 순서대로 CPU 할당
        - 소요시간이 긴 프로세스가 먼저 도달하여 효율성을 낮추는 현상 발생 가능
    - 최소작업 우선 스케줄링(SJF, Shortest Job First)
        - 큐 안에 있는 프로세스 중에서 수행시간이 짧은 것부터 먼저 수행 
        - 평균 대기 시간 줄어듬
        - 수행시간이 긴 프로세스는 영원히 CPU를 할당 받지 못 할 수도 있다. (starvation)
- 선점
    - 라운드 로빈 스케줄링(Round Robin)
        - 각 프로세스는 동일한 크기의 CPU 시간 할당
        - 할당 시간이 지나면 프로세스는 선점당하고 Ready Queue 의 제일 뒤로 감 (원형 큐)
        - 모든 프로세스가 공정하게 시간을 할당받기에 starvation 이 발생하지 않음
        - 프로세스 최악의 응답시간을 아는데 용이
        - 작업 시간을 너무 짧게 하면 Context Switching 이 자주 일어나 오버헤드 발생
 
- 우선순위 스케줄링(Priority)
    - Ready Queue 의 프로세스 중 우선순위가 가장 높은 프로세스에 CPU 할당
    - 선점 우선순위
        - 더 높은 우선순위의 프로세스가 도착하면 실행중인 프로세스 멈추고 CPU 선점
    - 비선점 우선순위
        - 더 높은 우선순위의 프로세스가 도착하면 Ready Queue 제일 앞(Head)에 넣어준다.
    - 오래 대기하는 프로세스는 우선순위를 점진적으로 증가 (aging)

## 참고
- https://kim6394.tistory.com/177
- https://www.crocus.co.kr/1373?category=268776